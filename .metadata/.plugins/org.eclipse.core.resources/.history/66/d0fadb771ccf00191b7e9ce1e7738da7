package com.qa.database;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class DBManager {
	static final String DB_URL = "jdbc:mysql://35.246.64.177/database?useSSL=false";
	static final String USER = "root";
	static final String PASS = "";
	
	Connection conn = null;
	Statement stmt = null;

	public void accessDB() {
		System.out.println("Accessing database...");
		try {
			//Class.forName("JDBC_DRIVER");
			conn = DriverManager.getConnection(DB_URL, USER, PASS);
			stmt = conn.createStatement();
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	
	public void createEmptyDB(String DB) {
		try {
			System.out.println("Creating an empty database...");
			
			stmt.executeUpdate("DROP DATABASE IF EXISTS " + DB); //if exists
			stmt.executeUpdate("CREATE DATABASE " + DB);
			stmt.executeUpdate("USE " + DB);
			
			System.out.println("Created an empty database called: " + DB + ", and are now using it.");
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	
	public void createTable(String table) {
		try {
			stmt.executeUpdate("DROP TABLE IF EXISTS " + table);
			stmt.executeUpdate("CREATE TABLE " + table + "(id INT PRIMARY KEY AUTO_INCREMENT, Turn_1 VARCHAR(100), Turn_2 VARCHAR(100), Turn_3 VARCHAR(100), Turn_4 VARCHAR(100), Turn_5 VARCHAR(100), Turn_6 VARCHAR(100), Turn_7 VARCHAR(100), Turn_8 VARCHAR(100), Turn_9 VARCHAR(100), Turn_10 VARCHAR(100), Turn_11 VARCHAR(100), Turn_12 VARCHAR(100));");
			
			System.out.println("Created a table with fields: id, name and year");
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
	}
	
	
	
	
	
}
